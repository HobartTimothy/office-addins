# 在 Office 中加载插件说明

## 前提条件
1. ✅ 开发服务器已启动（运行 `npm start`）
2. ✅ 服务器运行在 `https://localhost:3000`
3. ✅ 已安装依赖

## 在 Excel 中加载插件

### 方法一：通过文件加载（推荐用于开发测试）

1. **打开 Excel**
   - 打开 Microsoft Excel（桌面版或在线版）

2. **打开加载项菜单**
   - 点击顶部菜单栏的 **"插入"** 选项卡
   - 点击 **"我的加载项"** 按钮
   - 在下拉菜单中选择 **"上传我的加载项"**

3. **选择 manifest 文件**
   - 浏览到项目根目录
   - 选择 `manifest.xml` 文件
   - 点击 **"上传"**

4. **信任插件**
   - 如果出现安全警告，选择 **"信任此加载项"** 或 **"启用"**

5. **使用插件**
   - 插件加载后，会在功能区出现 **"S3 插件"** 选项卡
   - 点击 **"打开 S3 面板"** 按钮即可打开侧边栏

### 方法二：通过开发工具（适用于桌面版 Excel）

1. **打开 Excel**
2. **打开开发工具**
   - 文件 > 选项 > 自定义功能区
   - 勾选 **"开发工具"** 选项卡
3. **加载插件**
   - 点击 **"开发工具"** 选项卡
   - 点击 **"加载项"** 按钮
   - 选择 **"我的加载项"** > **"上传我的加载项"**
   - 选择 `manifest.xml` 文件

## 在 Word 中加载插件

步骤与 Excel 相同：
1. 打开 Word
2. 插入 > 我的加载项 > 上传我的加载项
3. 选择 `manifest.xml` 文件
4. 信任并启用插件

## 常见问题

### 1. HTTPS 证书警告
- 开发环境使用自签名证书，浏览器会显示警告
- 在浏览器中访问 `https://localhost:3000`，点击 **"高级"** > **"继续访问"** 以信任证书
- 或者将证书添加到系统信任列表

### 2. 插件无法加载
- 确保开发服务器正在运行（`npm start`）
- 检查 `manifest.xml` 中的 URL 是否为 `https://localhost:3000`
- 确保防火墙允许 localhost:3000 的 HTTPS 连接

### 3. 功能区按钮不显示
- 检查 Office 版本是否支持插件（Office 2016 或更高版本）
- 尝试重新加载插件
- 检查浏览器控制台是否有错误

### 4. 侧边栏空白
- 打开浏览器开发者工具（F12）查看控制台错误
- 确保 React 应用正常编译
- 检查 `https://localhost:3000/taskpane.html` 是否可以正常访问

## 测试步骤

1. ✅ 启动开发服务器：`npm start`
2. ✅ 在 Excel/Word 中加载 `manifest.xml`
3. ✅ 点击功能区中的 **"打开 S3 面板"** 按钮
4. ✅ 验证侧边栏正常显示
5. ✅ 测试 S3 文件浏览功能
6. ✅ 测试文件插入功能

## 开发调试

- 开发服务器支持热重载，修改代码后会自动刷新
- 可以在浏览器中直接访问 `https://localhost:3000/taskpane.html` 进行 UI 调试
- 使用 Office 开发者工具查看插件日志和错误信息

